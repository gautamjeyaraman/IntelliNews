import feedparser
from urlparse import urlparse
import re
import requests
from bs4 import BeautifulSoup

def feedFetcher():
    rssUrlList = ['http://www.thehindu.com/news/cities/Vijayawada/?service=rss', 'http://www.thehindu.com/business/markets/?service=rss', 'http://www.thehindu.com/features/education/careers/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/?service=rss', 'http://www.thehindu.com/sport/tennis/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-datum-line/?service=rss', 'http://www.thehindu.com/features/education/college-and-university/?service=rss', 'http://www.thehindu.com/business/?service=rss', 'http://www.thehindu.com/specials/timelines/?service=rss', 'http://www.thehindu.com/books/books-authors/?service=rss', 'http://www.thehindu.com/news/cities/Delhi/?service=rss', 'http://www.thehindu.com/features/cinema/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa-venues/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-hypertext/?service=rss', 'http://www.thehindu.com/features/metroplus/fitness/?service=rss', 'http://www.thehindu.com/news/national/other-states/?service=rss', 'http://www.thehindu.com/news/international/world/?service=rss', 'http://www.thehindu.com/opinion/interview/?service=rss', 'http://www.thehindu.com/features/metroplus/?service=rss', 'http://www.thehindu.com/news/national/andhra-pradesh/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/accessorize/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-datadelve/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa-quiz/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa-live-tracker/?service=rss', 'http://www.thehindu.com/sport/cricket/world-cup/wc-gallery/?service=rss', 'http://www.thehindu.com/news/national/tamil-nadu/?service=rss', 'http://www.thehindu.com/specials/live-chat/?service=rss', 'http://www.thehindu.com/specials/beijing-20/?service=rss', 'http://www.thehindu.com/features/friday-review/history-and-culture/?service=rss', 'http://www.thehindu.com/features/education/?service=rss', 'http://www.thehindu.com/sci-tech/energy-and-environment/?service=rss', 'http://www.thehindu.com/news/national/kerala/?service=rss', 'http://www.thehindu.com/business/budget/?service=rss', 'http://www.thehindu.com/news/cities/chennai/?service=rss', 'http://www.thehindu.com/features/metroplus/Food/?service=rss', 'http://www.thehindu.com/sunday-anchor/?service=rss', 'http://www.thehindu.com/news/cities/mumbai/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-terra-firma/?service=rss', 'http://www.thehindu.com/features/education/school/?service=rss', 'http://www.thehindu.com/features/metroplus/events/?service=rss', 'http://www.thehindu.com/sport/other-sports/?service=rss', 'http://www.thehindu.com/business/Economy/?service=rss', 'http://www.thehindu.com/news/national/telangana/?service=rss', 'http://www.thehindu.com/features/metroplus/radio-and-tv/?service=rss', 'http://www.thehindu.com/sci-tech/health/?service=rss', 'http://www.thehindu.com/features/friday-review/dance/?service=rss', 'http://www.thehindu.com/news/cities/Kochi/?service=rss', 'http://www.thehindu.com/features/metroplus/Motoring/?service=rss', 'http://www.thehindu.com/features/friday-review/art/?service=rss', 'http://www.thehindu.com/sci-tech/technology/internet/?service=rss', 'http://www.thehindu.com/books/books-children/?service=rss', 'http://www.thehindu.com/opinion/Readers-Editor/corrections-and-clarifications/?service=rss', 'http://www.thehindu.com/features/metroplus/travel/?service=rss', 'http://www.thehindu.com/opinion/op-ed/?service=rss', 'http://www.thehindu.com/opinion/blogs/?service=rss', 'http://www.thehindu.com/features/cinema/cinema-reviews/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa-standings/?service=rss', 'http://www.thehindu.com/sci-tech/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/q-and-a/?service=rss', 'http://www.thehindu.com/sport/cricket/world-cup/?service=rss', 'http://www.thehindu.com/books/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-science-of-the-times/?service=rss', 'http://www.thehindu.com/?service=rss', 'http://www.thehindu.com/features/friday-review/religion/?service=rss', 'http://www.thehindu.com/news/international/south-asia/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-urban-prospects/?service=rss', 'http://www.thehindu.com/news/national/?service=rss', 'http://www.thehindu.com/news/national/karnataka/?service=rss', 'http://www.thehindu.com/opinion/columns/?service=rss', 'http://www.thehindu.com/opinion/lead/?service=rss', 'http://www.thehindu.com/sport/football/?service=rss', 'http://www.thehindu.com/news/cities/puducherry/?service=rss', 'http://www.thehindu.com/opinion/?service=rss', 'http://www.thehindu.com/sci-tech/health/medicine-and-research/?service=rss', 'http://www.thehindu.com/features/friday-review/music/?service=rss', 'http://www.thehindu.com/features/metroplus/fashion/?service=rss', 'http://www.thehindu.com/opinion/editorial/?service=rss', 'http://www.thehindu.com/sport/hockey/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-by-the-way/?service=rss', 'http://www.thehindu.com/opinion/blogs/blogs-the-copernican/?service=rss', 'http://www.thehindu.com/news/cities/kolkata/?service=rss', 'http://www.thehindu.com/features/downtown/?service=rss', 'http://www.thehindu.com/sport/cricket/?service=rss', 'http://www.thehindu.com/business/budget/industry-impact/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/home-finance/?service=rss', 'http://www.thehindu.com/news/cities/Mangalore/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/green-living/?service=rss', 'http://www.thehindu.com/books/literary-review/?service=rss', 'http://www.thehindu.com/news/cities/Hyderabad/?service=rss', 'http://www.thehindu.com/sci-tech/technology/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-hawk-eye/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-free-for-all/?service=rss', 'http://www.thehindu.com/sci-tech/science/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-touchy-notes/?service=rss', 'http://www.thehindu.com/sport/cricket/match-statistics/?service=rss', 'http://www.thehindu.com/features/friday-review/?service=rss', 'http://www.thehindu.com/news/cities/Coimbatore/?service=rss', 'http://www.thehindu.com/opinion/blogs/blog-suhasini-haidar/?service=rss', 'http://www.thehindu.com/news/international/?service=rss', 'http://www.thehindu.com/opinion/Readers-Editor/?service=rss', 'http://www.thehindu.com/news/?service=rss', 'http://www.thehindu.com/news/cities/Madurai/?service=rss', 'http://www.thehindu.com/sport/cricket/ipl/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/?service=rss', 'http://www.thehindu.com/features/metroplus/nxg/?service=rss', 'http://www.thehindu.com/sport/?service=rss', 'http://www.thehindu.com/opinion/open-page/?service=rss', 'http://www.thehindu.com/features/friday-review/theatre/?service=rss', 'http://www.thehindu.com/sport/cricket/standings/?service=rss', 'http://www.thehindu.com/books/books-reviews/?service=rss', 'http://www.thehindu.com/books/books-columns/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/gardens/?service=rss', 'http://www.thehindu.com/specials/in-depth/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa-gallery/?service=rss', 'http://www.thehindu.com/features/cinema/cinema-columns/?service=rss', 'http://www.thehindu.com/business/Industry/?service=rss', 'http://www.thehindu.com/features/magazine/?service=rss', 'http://www.thehindu.com/opinion/letters/?service=rss', 'http://www.thehindu.com/sport/cricket/fixtures/?service=rss', 'http://www.thehindu.com/features/magazine/mag-columns/?service=rss', 'http://www.thehindu.com/sci-tech/health/policy-and-issues/?service=rss', 'http://www.thehindu.com/news/cities/bangalore/?service=rss', 'http://www.thehindu.com/sport/football/fifa-2014/fifa2014-videos/?service=rss', 'http://www.thehindu.com/news/cities/Thiruvananthapuram/?service=rss', 'http://www.thehindu.com/features/homes-and-gardens/design/?service=rss', 'http://www.thehindu.com/entertainment/?service=rss', 'http://www.thehindu.com/features/lit-for-life/?service=rss', 'http://www.thehindu.com/sport/races/?service=rss', 'http://www.thehindu.com/news/cities/kozhikode/?service=rss', 'http://www.thehindu.com/specials/?service=rss', 'http://www.thehindu.com/features/metroplus/society/?service=rss', 'http://www.thehindu.com/news/cities/Visakhapatnam/?service=rss', 'http://www.thehindu.com/news/cities/Tiruchirapalli/?service=rss', 'http://www.thehindu.com/features/kids/?service=rss', 'http://www.thehindu.com/news/cities/?service=rss', 'http://www.thehindu.com/books/know-your-english/?service=rss', 'http://www.thehindu.com/features/?service=rss', 'http://www.thehindu.com/sci-tech/technology/gadgets/?service=rss', 'http://www.thehindu.com/sport/cricket/match-results/?service=rss']

    for i in rssUrlList:
        url = feedparser.parse(i)
        for x in url['entries']:
            docUrl = x['link']
            docDate = x['published']
            docTitle = x['title']
            fetchHtml = requests.get(docUrl)
            soup = BeautifulSoup(fetchHtml.content)
            docImage = soup.findAll(id='pic')
            if not docImage :
                docImage =soup.findAll(id='hcenter')
                if not docImage :
                    docImage =soup.find_all(class_='text-embed')
            if docImage:
                docImage = docImage[0].img.get("src")
            else:
                docImage = None
                print docUrl
                
            docContent="\n".join([x.getText() for x in soup.find_all(class_="body")])
            rssUrlparse = urlparse(docUrl)
            tags = re.split("/", rssUrlparse.path)
            docType = tags[1:-1]
            '''print docUrl
            print docDate
            print docTitle
            print docContent'''
            print docImage
            print #tags
            


feedFetcher()
